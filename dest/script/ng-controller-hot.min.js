/*! my-project-name - v0.0.1 - 2014-11-07 */

myCtrl.controller("HotCtrl",["$scope",function(a){a.pageClass="hot",a.title="热销美食"}]),myCtrl.controller("HotMainCtrl",["$scope","$http","$window",function(a,b,c){function d(){var a="http://handset.line0.com/ws/handset/v3/mcms/guess?jsonp=getHot",c={params:{userX:longitude,userY:latitude,cityId:cityId,toPage:1,pageRows:10}};b.jsonp(a,c).success()}function e(){if(a.curPage=parseInt(a.curPage)+1,a.curPage>a.totalPage)return g.className="show",g.innerHTML="没有更多数据了",myScrollHot.refresh(),void(f=0);var c="http://handset.line0.com/ws/handset/v3/mcms/guess?jsonp=getMoreGuess",d={params:{userX:longitude,userY:latitude,cityId:cityId,toPage:a.curPage,pageRows:10}};b.jsonp(c,d).success()}var f=0,g=document.getElementById("shop-list-pullDown");a.StateHotMain=!0,a.StateHotRefresh=!0,$.getScript("lib/other/iscroll-probe.min.js",function(){myScrollHot=new IScroll("#scroller",{tap:!0,preventDefault:!1,probeType:2}),document.addEventListener("touchmove",function(a){a.preventDefault()},!1)}),getLocation(d),c.getHot=function(b){a.guessLikeOnes=b.response.guessLikeOnes,a.curPage=b.response.page.curPage,a.totalPage=b.response.page.pageAmount,imgLen=b.response.guessLikeOnes.length},a.$on("ngRepeatFinished",function(){$.getScript("lib/jquery/jq-waterfall.min.js",function(){var a=$(".waterfall").find("li");a.wookmark({container:$(".waterfall"),direction:"left",itemWidth:"48%",flexibleWidth:"48%",fillEmptySpace:!1,outerOffset:10,offset:10,onLayoutChanged:function(){$(".spin_refresh").hide(),$.getScript("lib/other/iscroll-probe.min.js",function(){g.className="",g.innerHTML="下拉准备刷新...",f=0,myScrollHot.refresh(),myScrollHot.on("scroll",function(){0!=f||g.className.match("show|loading")||this.y>5||this.y<this.maxScrollY-5&&(g.className="show",myScrollHot.refresh(),f=1)}),myScrollHot.on("scrollEnd",function(){1==f&&g.className.match("show|loading")&&(g.className="loading",g.innerHTML='<i class="icon-spin animate-spin"></i>',f=2,e())})})}})})}),c.getMoreGuess=function(b){imgLen=b.response.guessLikeOnes.length,a.guessLikeOnes=a.guessLikeOnes.concat(b.response.guessLikeOnes)}}]);