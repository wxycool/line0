myCtrl.controller("SearchCtrl", [ "$scope", "$rootScope", "$http", "$window", function(a) {
    a.pageClass = "search";
} ]), myCtrl.controller("SearchMainCtrl", [ "$scope", "$rootScope", "$http", "$window", function(a, b, c, d) {
    //console.log(pullDownEl);
    //初始化页面数据——定义
    function e() {
        var a = "http://handset.line0.com/ws/handset/v3/search/shop?jsonp=getShopList&cityId=" + cityId + "&userX=" + longitude + "&userY=" + latitude + "&toPage=1&pageRows=100&keyword=" + b.shopName;
        //var url = '../data/shopList.json?jsonp=getShopListByName';
        c.jsonp(a).success();
    }
    //加载更多数据-----定义
    function f() {
        //console.log($scope.curPage, $scope.totalPage);
        // 判断是否显示加载更多数据
        if (a.curPage = parseInt(a.curPage) + 1, a.curPage > a.totalPage) return g.className = "show", 
        g.innerHTML = "没有更多数据了", myScrollSearch.refresh(), void (h = 0);
        var d = "http://handset.line0.com/ws/handset/v3/search/shop?jsonp=getMoreShopByPage&cityId=1&userX=118.793527&userY=32.013613&toPage=" + a.curPage + "&pageRows=100&keyword=" + b.shopName;
        //var url = '../data/shopList.json?jsonp=getMoreShopByPage';
        c.jsonp(d).success();
    }
    a.shopList = [];
    //$rootScope.shopName = '饭';		/* 自来水 村 米线 米 鱼 */
    //console.log($rootScope.shopName);
    var g = (document.getElementById("shop-list-pullUp"), document.getElementById("shop-list-pullDown")), h = 0;
    d.getShopList = function(b) {
        //console.log(data);
        a.shopList = b.response.shopList, a.shopPage = b.response.page, a.totalRow = a.shopPage.totalRows, 
        a.curPage = a.shopPage.curPage, a.totalPage = a.shopPage.pageAmount, //console.log($scope.shopList.length, $scope.shopList);
        1 === a.shopList.length && void 0 == a.shopList[0].shopId && (a.shopList = null, 
        a.searchListEmpty = !0, a.show_error = "米有找到相关的店铺，请换个关键字试试"), a.StateSearchRefresh = !1, 
        $.getScript("lib/other/iscroll-probe.min.js", function() {
            myScrollSearch = new IScroll("#scroller", {
                tap: !0,
                preventDefault: !1,
                probeType: 2
            }), document.addEventListener("touchmove", function(a) {
                a.preventDefault();
            }, !1), // 加载更多数据----绑定滚动事件
            myScrollSearch.on("scroll", function() {
                //console.log(this.y, (this.maxScrollY - 5));
                0 != h || g.className.match("show|loading") || this.y > 5 || this.y < this.maxScrollY - 5 && (//下拉准备刷新效果
                //console.log('down');
                g.className = "show", myScrollSearch.refresh(), h = 1);
            }), myScrollSearch.on("scrollEnd", function() {
                1 == h && g.className.match("show|loading") && (g.className = "loading", g.innerHTML = '<i class="icon-spin animate-spin"></i>', 
                h = 2, f());
            });
        });
    }, d.getMoreShopByPage = function(b) {
        //console.log(data);
        a.shopList = a.shopList.concat(b.response.shopList), //console.log($scope.shopList.length, $scope.shopList);
        //console.log($scope.shopList);
        $.getScript("lib/other/iscroll-probe.min.js", function() {
            g.className = "", g.innerHTML = "下拉准备刷新...", myScrollSearch.refresh(), h = 0;
        });
    }, //初始化数据调用
    a.searchListExist = !0, a.searchListEmpty = !1, a.StateSearchRefresh = !0, null != b.shopName ? getLocation(e) : (a.searchListEmpty = !0, 
    a.show_error = "请输入商店名称");
} ]);